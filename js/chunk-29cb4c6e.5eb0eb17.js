(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29cb4c6e"],{1276:function(e,t,r){"use strict";var n=r("2ba4"),c=r("c65b"),o=r("e330"),a=r("d784"),l=r("44e7"),d=r("825a"),i=r("1d80"),s=r("4840"),u=r("8aa5"),m=r("50c4"),p=r("577e"),b=r("dc4a"),O=r("4dae"),j=r("14c3"),h=r("9263"),f=r("9f7f"),g=r("d039"),E=f.UNSUPPORTED_Y,V=4294967295,N=Math.min,v=[].push,x=o(/./.exec),y=o(v),w=o("".slice),k=!g((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));a("split",(function(e,t,r){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var o=p(i(this)),a=void 0===r?V:r>>>0;if(0===a)return[];if(void 0===e)return[o];if(!l(e))return c(t,o,e,a);var d,s,u,m=[],b=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),j=0,f=new RegExp(e.source,b+"g");while(d=c(h,f,o)){if(s=f.lastIndex,s>j&&(y(m,w(o,j,d.index)),d.length>1&&d.index<o.length&&n(v,m,O(d,1)),u=d[0].length,j=s,m.length>=a))break;f.lastIndex===d.index&&f.lastIndex++}return j===o.length?!u&&x(f,"")||y(m,""):y(m,w(o,j)),m.length>a?O(m,0,a):m}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:c(t,this,e,r)}:t,[function(t,r){var n=i(this),a=void 0==t?void 0:b(t,e);return a?c(a,t,n,r):c(o,p(n),t,r)},function(e,n){var c=d(this),a=p(e),l=r(o,c,a,n,o!==t);if(l.done)return l.value;var i=s(c,RegExp),b=c.unicode,O=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(E?"g":"y"),h=new i(E?"^(?:"+c.source+")":c,O),f=void 0===n?V:n>>>0;if(0===f)return[];if(0===a.length)return null===j(h,a)?[a]:[];var g=0,v=0,x=[];while(v<a.length){h.lastIndex=E?0:v;var k,M=j(h,E?w(a,v):a);if(null===M||(k=N(m(h.lastIndex+(E?v:0)),a.length))===g)v=u(a,v,b);else{if(y(x,w(a,g,v)),x.length===f)return x;for(var D=1;D<=M.length-1;D++)if(y(x,M[D]),x.length===f)return x;v=g=k}}return y(x,w(a,g)),x}]}),!k,E)},"14c3":function(e,t,r){var n=r("da84"),c=r("c65b"),o=r("825a"),a=r("1626"),l=r("c6b6"),d=r("9263"),i=n.TypeError;e.exports=function(e,t){var r=e.exec;if(a(r)){var n=c(r,e,t);return null!==n&&o(n),n}if("RegExp"===l(e))return c(d,e,t);throw i("RegExp#exec called on incompatible receiver")}},"44e7":function(e,t,r){var n=r("861d"),c=r("c6b6"),o=r("b622"),a=o("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==c(e))}},5651:function(e,t,r){"use strict";r.r(t);var n=r("7a23"),c={class:"px-6 py-3"},o={class:"d-flex justify-content-end align-items-center my-4"},a=Object(n["createElementVNode"])("span",{class:"material-icons align-middle me-2"},"delete",-1),l=Object(n["createTextVNode"])(" 清空全部訂單 "),d=[a,l],i={class:"table table-borderless mb-4"},s=Object(n["createElementVNode"])("thead",{class:"border-bottom border-primary text-light"},[Object(n["createElementVNode"])("tr",null,[Object(n["createElementVNode"])("th",{scope:"col",width:"130"},"購買時間"),Object(n["createElementVNode"])("th",{scope:"col",class:"text-start",width:"250"},"訂單編號"),Object(n["createElementVNode"])("th",{scope:"col",width:"300"},"Email"),Object(n["createElementVNode"])("th",{scope:"col",width:"300"},"購買品項"),Object(n["createElementVNode"])("th",{scope:"col",width:"150"},"應付金額"),Object(n["createElementVNode"])("th",{scope:"col",width:"150"},"訂單狀態"),Object(n["createElementVNode"])("th",{scope:"col",width:"150"},"編輯 / 刪除")])],-1),u={class:"text-start"},m={class:"form-check form-switch p-0"},p=["onUpdate:modelValue","onChange"],b={class:"btn-group-sm"},O=["onClick"],j=["disabled","onClick"];function h(e,t,r,a,l,h){var f=Object(n["resolveComponent"])("Loading"),g=Object(n["resolveComponent"])("AdminOrderModal"),E=Object(n["resolveComponent"])("AdminDelModal"),V=Object(n["resolveComponent"])("Pagination");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[Object(n["createVNode"])(f,{active:l.isLoading,"onUpdate:active":t[0]||(t[0]=function(e){return l.isLoading=e})},null,8,["active"]),Object(n["createElementVNode"])("div",c,[Object(n["createElementVNode"])("div",o,[Object(n["createElementVNode"])("button",{type:"button",class:"btn btn-outline-danger d-flex align-items-center px-3 py-2",onClick:t[1]||(t[1]=function(e){return h.openModal("orderAllDelete")})},d)]),Object(n["createElementVNode"])("table",i,[s,Object(n["createElementVNode"])("tbody",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.orders,(function(e){return Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",{class:"border-bottom align-middle",key:e.id},[Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(e.create_at),1),Object(n["createElementVNode"])("td",u,Object(n["toDisplayString"])(e.id),1),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(e.user.email),1),Object(n["createElementVNode"])("td",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.products,(function(e){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:e.id},Object(n["toDisplayString"])(e.product.title),1)})),128))]),Object(n["createElementVNode"])("td",null,"NT$ "+Object(n["toDisplayString"])(e.total),1),Object(n["createElementVNode"])("td",null,[Object(n["createElementVNode"])("div",m,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:"form-check-input ms-0 me-3",type:"checkbox",role:"switch",id:"order.id","onUpdate:modelValue":function(t){return e.is_paid=t},"true-value":!0,"false-value":!1,onChange:function(t){return h.updateOrder(e)}},null,40,p),[[n["vModelCheckbox"],e.is_paid]]),Object(n["createElementVNode"])("label",{class:Object(n["normalizeClass"])(["form-check-label",{"text-success":e.is_paid,"text-danger":!e.is_paid}]),for:"order.id"},Object(n["toDisplayString"])(e.is_paid?"已付款":"未付款"),3)])]),Object(n["createElementVNode"])("td",null,[Object(n["createElementVNode"])("div",b,[Object(n["createElementVNode"])("button",{type:"button",class:"btn btn-outline-primary me-2",onClick:function(t){return h.openModal("orderModal",e)}}," 詳情 ",8,O),Object(n["createElementVNode"])("button",{type:"button",class:"btn btn-outline-danger",disabled:e.is_paid,onClick:function(t){return h.openModal("orderDelete",e)}}," 刪除 ",8,j)])])])})),128))])]),Object(n["createVNode"])(g,{ref:"orderModal",orders:l.orders,"temp-order":l.tempOrder,onGetOrders:h.getOrders},null,8,["orders","temp-order","onGetOrders"]),Object(n["createVNode"])(E,{ref:"delModal","del-modal-status":l.delModalStatus,"temp-order":l.tempOrder,onGetOrders:h.getOrders},null,8,["del-modal-status","temp-order","onGetOrders"]),Object(n["createVNode"])(V,{pages:l.pagination,onEmitPages:h.getOrders},null,8,["pages","onEmitPages"])])],64)}var f=r("5530"),g=(r("99af"),r("d3b7"),r("159b"),r("ac1f"),r("1276"),r("1799")),E=(r("b0c0"),{id:"orderModal",ref:"modal",class:"modal fade","aria-labelledby":"orderModalLabel","aria-hidden":"true"}),V={class:"modal-dialog modal-xl"},N={class:"modal-content border-0"},v={class:"modal-header bg-primary"},x={id:"orderModalLabel",class:"modal-title text-white"},y=Object(n["createElementVNode"])("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),w={class:"modal-body"},k={class:"d-flex justify-content-between align-items-baseline bg-secondary p-2 mb-3"},M=Object(n["createTextVNode"])("訂單狀態： "),D={key:0,class:"text-light fs-2"},T={class:"text-light"},S={class:"row"},_={class:"col-md-5"},C=Object(n["createElementVNode"])("div",{class:"mb-3"},[Object(n["createElementVNode"])("h3",null,"訂購資訊")],-1),B={class:"list-unstyled ms-2"},U={class:"d-flex justify-content-between align-items-center mb-2"},$=Object(n["createTextVNode"])(" 建立時間： "),L={class:"d-flex justify-content-between align-items-center mb-2"},F=Object(n["createTextVNode"])(" 姓名： "),A={class:"d-flex justify-content-between align-items-center mb-2"},I=Object(n["createTextVNode"])(" 信箱： "),R={class:"d-flex justify-content-between align-items-center mb-2"},P=Object(n["createTextVNode"])(" 電話： "),G={class:"d-flex justify-content-between align-items-center mb-2"},q=Object(n["createTextVNode"])(" 地址： "),Y={class:"d-flex justify-content-between align-items-start mb-2"},z=Object(n["createTextVNode"])(" 備註： "),H={class:"col-md-7"},J=Object(n["createElementVNode"])("h3",{class:"mb-2"},"購買商品",-1),X={class:"table"},K=Object(n["createElementVNode"])("thead",null,[Object(n["createElementVNode"])("tr",null,[Object(n["createElementVNode"])("th",{scope:"col",width:"60"},"NO."),Object(n["createElementVNode"])("th",{scope:"col",width:"250"},"商品名稱"),Object(n["createElementVNode"])("th",{scope:"col",width:"100"},"數量"),Object(n["createElementVNode"])("th",{scope:"col",width:"120"},"金額"),Object(n["createElementVNode"])("th",{scope:"col"},"刪除")])],-1),Q={scope:"row"},W=["onUpdate:modelValue"],Z=Object(n["createElementVNode"])("td",null,[Object(n["createElementVNode"])("button",{type:"button",class:"btn py-0"},[Object(n["createElementVNode"])("span",{class:"material-icons align-middle"},"delete_outline")])],-1),ee={class:"text-end"},te={key:0,class:"fw-medium text-primary"},re={class:"fw-medium"},ne=Object(n["createTextVNode"])("訂單總金額："),ce={class:"text-danger fs-4 fw-bold"},oe=Object(n["createElementVNode"])("small",{class:"text-light fs-1"},"(不滿 NT$ 1000 會加運費 NT$ 60)",-1),ae={class:"modal-footer"},le=Object(n["createElementVNode"])("button",{type:"button",class:"btn btn-outline-light","data-bs-dismiss":"modal"}," 取消 ",-1);function de(e,t,r,c,o,a){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",E,[Object(n["createElementVNode"])("div",V,[Object(n["createElementVNode"])("div",N,[Object(n["createElementVNode"])("div",v,[Object(n["createElementVNode"])("h5",x,[Object(n["createElementVNode"])("span",null,"訂單編號："+Object(n["toDisplayString"])(e.tempOrder.id),1)]),y]),Object(n["createElementVNode"])("div",w,[Object(n["createElementVNode"])("div",k,[Object(n["createElementVNode"])("h5",null,[M,Object(n["createElementVNode"])("span",{class:Object(n["normalizeClass"])(["fw-bold me-3",{"text-success":e.tempOrder.is_paid,"text-danger":!e.tempOrder.is_paid,"border-success":e.tempOrder.is_paid,"border-danger":!e.tempOrder.is_paid}])},Object(n["toDisplayString"])(e.tempOrder.is_paid?"已付款":"未付款"),3),e.tempOrder.is_paid?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",D,Object(n["toDisplayString"])(e.tempOrder.paidDate),1)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("p",T,"最後更新時間："+Object(n["toDisplayString"])(e.tempOrder.finalUpdateTime),1)]),Object(n["createElementVNode"])("div",S,[Object(n["createElementVNode"])("div",_,[C,Object(n["createElementVNode"])("ul",B,[Object(n["createElementVNode"])("li",U,[$,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",class:"form-control w-75 py-1",readonly:"","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.tempOrder.create_at=t})},null,512),[[n["vModelText"],e.tempOrder.create_at]])]),Object(n["createElementVNode"])("li",L,[F,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",class:"form-control w-75 py-1","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.tempOrder.user.name=t})},null,512),[[n["vModelText"],e.tempOrder.user.name]])]),Object(n["createElementVNode"])("li",A,[I,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",class:"form-control w-75 py-1","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.tempOrder.user.email=t})},null,512),[[n["vModelText"],e.tempOrder.user.email]])]),Object(n["createElementVNode"])("li",R,[P,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",class:"form-control w-75 py-1","onUpdate:modelValue":t[3]||(t[3]=function(t){return e.tempOrder.user.tel=t})},null,512),[[n["vModelText"],e.tempOrder.user.tel]])]),Object(n["createElementVNode"])("li",G,[q,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",class:"form-control w-75 py-1","onUpdate:modelValue":t[4]||(t[4]=function(t){return e.tempOrder.user.address=t})},null,512),[[n["vModelText"],e.tempOrder.user.address]])]),Object(n["createElementVNode"])("li",Y,[z,Object(n["withDirectives"])(Object(n["createElementVNode"])("textarea",{type:"text",class:"form-control w-75",id:"message",name:"留言","onUpdate:modelValue":t[5]||(t[5]=function(t){return e.tempOrder.message=t})},null,512),[[n["vModelText"],e.tempOrder.message]])])])]),Object(n["createElementVNode"])("div",H,[J,Object(n["createElementVNode"])("table",X,[K,Object(n["createElementVNode"])("tbody",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.tempOrder.products,(function(e,r,c){return Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",{key:r,class:"align-middle"},[Object(n["createElementVNode"])("th",Q,Object(n["toDisplayString"])(c+1),1),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(e.product.title),1),Object(n["createElementVNode"])("td",null,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"number",class:"form-control text-center","onUpdate:modelValue":function(t){return e.qty=t},onChange:t[6]||(t[6]=function(){return a.updateTotal&&a.updateTotal.apply(a,arguments)})},null,40,W),[[n["vModelText"],e.qty]])]),Object(n["createElementVNode"])("td",null,"NT$ "+Object(n["toDisplayString"])(e.final_total),1),Z])})),128))])]),Object(n["createElementVNode"])("div",ee,[o.coupon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",te,"優惠碼："+Object(n["toDisplayString"])(o.coupon),1)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("p",re,[ne,Object(n["createElementVNode"])("span",ce,"NT$ "+Object(n["toDisplayString"])(e.tempOrder.total),1)]),oe])])])]),Object(n["createElementVNode"])("div",ae,[le,Object(n["createElementVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[7]||(t[7]=function(t){return a.updateOrder(e.tempOrder.id)})}," 確認 ")])])])],512)}r("b64b");var ie=r("e0ae"),se={props:["temp-order"],data:function(){return{coupon:""}},mixins:[ie["a"]],methods:{updateOrder:function(e){var t=this;this.$nextTick((function(){t.tempOrder.create_at=Math.floor(new Date(t.tempOrder.create_at)/1e3);var r=new Date((new Date).getTime());t.tempOrder.finalUpdateTime="".concat(r.getFullYear(),"-").concat(r.getMonth()+1,"-").concat(r.getDate()," ").concat(r.getHours(),":").concat(r.getMinutes(),":").concat(r.getSeconds());var n="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("gillchin","/admin/order/").concat(e);t.$http.put(n,{data:t.tempOrder}).then((function(e){t.$httpMessageState(e,"更新訂單"),t.hideModal(),t.$emit("get-orders")})).catch((function(e){t.$httpMessageState(e.response,"更新訂單")}))}))},updateTotal:function(){var e=this,t=Object.keys(this.tempOrder.products),r=0;t.forEach((function(t){e.tempOrder.products[t].total=e.tempOrder.products[t].qty*e.tempOrder.products[t].product.price,e.tempOrder.products[t].final_total=e.tempOrder.products[t].total*(e.tempOrder.products[t].coupon.percent/100),r+=e.tempOrder.products[t].final_total})),this.tempOrder.total=r}},watch:{tempOrder:function(){var e=this,t=Object.keys(this.tempOrder.products);if(t.forEach((function(t){e.tempOrder.products[t].coupon?e.coupon=e.tempOrder.products[t].coupon.title:e.coupon=""})),this.tempOrder.is_paid){var r=new Date(1e3*this.tempOrder.paid_date),n=r.getFullYear(),c=r.getMonth()+1,o=r.getDate(),a=r.getHours(),l=r.getMinutes(),d=r.getSeconds();this.tempOrder.paidDate="".concat(n,"-").concat(c,"-").concat(o," ").concat(a,":").concat(l,":").concat(d)}}}},ue=r("6b0d"),me=r.n(ue);const pe=me()(se,[["render",de]]);var be=pe,Oe=r("c00e"),je={data:function(){return{orders:{},pagination:{},tempOrder:{user:{}},delModalStatus:"",isLoading:!1}},components:{Pagination:g["a"],AdminOrderModal:be,AdminDelModal:Oe["a"]},methods:{getOrders:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;console.log(t),this.isLoading=!0;var r="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("gillchin","/admin/orders?page=").concat(t);this.$http.get(r).then((function(t){e.orders=t.data.orders,e.pagination=t.data.pagination,e.addFreight(),e.isLoading=!1})).catch((function(e){console.log(e.response)}))},updateOrder:function(e){this.tempOrder=Object(f["a"])({},e),this.tempOrder.paid_date=(new Date).getTime()/1e3,this.$refs.orderModal.updateOrder(e.id)},openModal:function(e,t){"orderModal"===e?(this.tempOrder=Object(f["a"])({},t),this.$refs.orderModal.openModal()):"orderDelete"===e?(this.tempOrder=Object(f["a"])({},t),this.delModalStatus=e,this.$refs.delModal.openModal()):"orderAllDelete"===e&&(this.delModalStatus=e,this.$refs.delModal.openModal())},addFreight:function(){this.orders.forEach((function(e){e.total<1e3&&(e.total=e.total+60)}))}},watch:{orders:function(){this.orders.forEach((function(e){e.create_at=new Date(1e3*e.create_at).toISOString().split("T")[0]}))}},mounted:function(){this.getOrders()}};const he=me()(je,[["render",h]]);t["default"]=he},"8aa5":function(e,t,r){"use strict";var n=r("6547").charAt;e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},b0c0:function(e,t,r){var n=r("83ab"),c=r("5e77").EXISTS,o=r("e330"),a=r("9bf2").f,l=Function.prototype,d=o(l.toString),i=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,s=o(i.exec),u="name";n&&!c&&a(l,u,{configurable:!0,get:function(){try{return s(i,d(this))[1]}catch(e){return""}}})},d784:function(e,t,r){"use strict";r("ac1f");var n=r("e330"),c=r("6eeb"),o=r("9263"),a=r("d039"),l=r("b622"),d=r("9112"),i=l("species"),s=RegExp.prototype;e.exports=function(e,t,r,u){var m=l(e),p=!a((function(){var t={};return t[m]=function(){return 7},7!=""[e](t)})),b=p&&!a((function(){var t=!1,r=/a/;return"split"===e&&(r={},r.constructor={},r.constructor[i]=function(){return r},r.flags="",r[m]=/./[m]),r.exec=function(){return t=!0,null},r[m](""),!t}));if(!p||!b||r){var O=n(/./[m]),j=t(m,""[e],(function(e,t,r,c,a){var l=n(e),d=t.exec;return d===o||d===s.exec?p&&!a?{done:!0,value:O(t,r,c)}:{done:!0,value:l(r,t,c)}:{done:!1}}));c(String.prototype,e,j[0]),c(s,m,j[1])}u&&d(s[m],"sham",!0)}}}]);
//# sourceMappingURL=chunk-29cb4c6e.5eb0eb17.js.map